import { parseEther } from 'viem';
import { useWalletClient, usePublicClient } from 'wagmi';

// Contract ABI from your compiled contract
export const roscaAbi = [
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "_totalParticipants",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "_totalAmount",
          "type": "uint256"
        }
      ],
      "stateMutability": "payable",
      "type": "constructor"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "address",
          "name": "participant",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "round",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "amount",
          "type": "uint256"
        }
      ],
      "name": "ContributionMade",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "address",
          "name": "participant",
          "type": "address"
        }
      ],
      "name": "ParticipantRegistered",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "address",
          "name": "recipient",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "round",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "amount",
          "type": "uint256"
        }
      ],
      "name": "PoolDistributed",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "roundNumber",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "address",
          "name": "recipient",
          "type": "address"
        }
      ],
      "name": "RoundStarted",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "actualTotalAmount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "user",
          "type": "address"
        }
      ],
      "name": "canClaimPool",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "contribute",
      "outputs": [],
      "stateMutability": "payable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "contributionAmount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "currentRound",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "distributePool",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "getCurrentRoundStatus",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "roundNumber",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "recipient",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "totalContributed",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "targetAmount",
          "type": "uint256"
        },
        {
          "internalType": "bool",
          "name": "isDistributed",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "getRemainingContribution",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "user",
          "type": "address"
        }
      ],
      "name": "hasContributed",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "participantList",
      "outputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "name": "participants",
      "outputs": [
        {
          "internalType": "address",
          "name": "user",
          "type": "address"
        },
        {
          "internalType": "bool",
          "name": "isAdmin",
          "type": "bool"
        },
        {
          "internalType": "uint256",
          "name": "lastPaid",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "registerParticipant",
      "outputs": [],
      "stateMutability": "payable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "rounds",
      "outputs": [
        {
          "internalType": "address",
          "name": "recipient",
          "type": "address"
        },
        {
          "internalType": "bool",
          "name": "distributed",
          "type": "bool"
        },
        {
          "internalType": "uint256",
          "name": "totalContributed",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "totalAmount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "totalParticipants",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    }
  ] as const;

// Contract bytecode from your compiled contract
export const roscaBytecode = "0x6080604052604051611f21380380611f2183398181016040528101906100259190610519565b816002819055508060008190555060025460005461004391906105b7565b60038190555060025460035461005991906105e8565b60018190555060035434146100a3576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161009a90610687565b60405180910390fd5b6100b433600161012060201b60201c565b336007600080815260200190815260200160002060000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550610119333461026d60201b60201c565b505061081f565b60405180606001604052808373ffffffffffffffffffffffffffffffffffffffff168152602001821515815260200142815250600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160000160146101000a81548160ff021916908315150217905550604082015181600101559050506006829080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050565b61027c8261044360201b60201c565b6102bb576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102b2906106f3565b60405180910390fd5b60035481146102ff576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102f69061075f565b60405180910390fd5b60076000600454815260200190815260200160002060010160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16156103a2576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610399906107cb565b60405180910390fd5b600160076000600454815260200190815260200160002060010160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555080600760006004548152602001908152602001600020600201600082825461043891906107eb565b925050819055505050565b60008073ffffffffffffffffffffffffffffffffffffffff16600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614159050919050565b600080fd5b6000819050919050565b6104f6816104e3565b811461050157600080fd5b50565b600081519050610513816104ed565b92915050565b600080604083850312156105305761052f6104de565b5b600061053e85828601610504565b925050602061054f85828601610504565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006105c2826104e3565b91506105cd836104e3565b9250826105dd576105dc610559565b5b828204905092915050565b60006105f3826104e3565b91506105fe836104e3565b925082820261060c816104e3565b9150828204841483151761062357610622610588565b5b5092915050565b600082825260208201905092915050565b7f496e76616c696420436f6e747269627574696f6e20416d6f756e740000000000600082015250565b6000610671601b8361062a565b915061067c8261063b565b602082019050919050565b600060208201905081810360008301526106a081610664565b9050919050565b7f4e6f7420612072656769737465726564207061727469636970616e7400000000600082015250565b60006106dd601c8361062a565b91506106e8826106a7565b602082019050919050565b6000602082019050818103600083015261070c816106d0565b9050919050565b7f496e76616c696420636f6e747269627574696f6e20616d6f756e740000000000600082015250565b6000610749601b8361062a565b915061075482610713565b602082019050919050565b600060208201905081810360008301526107788161073c565b9050919050565b7f416c726561647920636f6e7472696275746564207468697320726f756e640000600082015250565b60006107b5601e8361062a565b91506107c08261077f565b602082019050919050565b600060208201905081810360008301526107e4816107a8565b9050919050565b60006107f6826104e3565b9150610801836104e3565b925082820190508082111561081957610818610588565b5b92915050565b6116f38061082e6000396000f3fe6080604052600436106100e85760003560e01c80635fa0b65f1161008a578063a26dbf2611610059578063a26dbf2614610314578063ccfc811b1461033f578063d7bb99ba14610349578063ecf8132514610353576100e8565b80635fa0b65f146102545780638a19c8bc1461027f5780638c65c81f146102aa578063a1aa4dd5146102e9576100e8565b806311c829db116100c657806311c829db146101985780631a39d8ef146101d5578063205b1946146102005780633e4a4fcf1461023d576100e8565b806309e69ede146100ed5780630d31d8351461012c5780630e6fdaa11461015b575b600080fd5b3480156100f957600080fd5b50610114600480360381019061010f9190610f62565b61037e565b60405161012393929190610fd2565b60405180910390f35b34801561013857600080fd5b506101416103d5565b604051610152959493929190611009565b60405180910390f35b34801561016757600080fd5b50610182600480360381019061017d9190611088565b610449565b60405161018f91906110b5565b60405180910390f35b3480156101a457600080fd5b506101bf60048036038101906101ba9190610f62565b610488565b6040516101cc91906110d0565b60405180910390f35b3480156101e157600080fd5b506101ea61055b565b6040516101f791906110eb565b60405180910390f35b34801561020c57600080fd5b5061022760048036038101906102229190610f62565b610561565b60405161023491906110d0565b60405180910390f35b34801561024957600080fd5b506102526105cd565b005b34801561026057600080fd5b5061026961079f565b60405161027691906110eb565b60405180910390f35b34801561028b57600080fd5b506102946107a5565b6040516102a191906110eb565b60405180910390f35b3480156102b657600080fd5b506102d160048036038101906102cc9190611088565b6107ab565b6040516102e093929190610fd2565b60405180910390f35b3480156102f557600080fd5b506102fe610802565b60405161030b91906110eb565b60405180910390f35b34801561032057600080fd5b50610329610808565b60405161033691906110eb565b60405180910390f35b61034761080e565b005b610351610932565b005b34801561035f57600080fd5b5061036861097b565b60405161037591906110eb565b60405180910390f35b60056020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060000160149054906101000a900460ff16908060010154905083565b60008060008060008060076000600454815260200190815260200160002090506004548160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1682600201546001548460000160149054906101000a900460ff1695509550955095509550509091929394565b6006818154811061045957600080fd5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600060025460045410801561050057508173ffffffffffffffffffffffffffffffffffffffff1660076000600454815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b8015610525575060015460076000600454815260200190815260200160002060020154145b8015610554575060076000600454815260200190815260200160002060000160149054906101000a900460ff16155b9050919050565b60005481565b600060076000600454815260200190815260200160002060010160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff169050919050565b6105d6336109e6565b610615576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161060c90611163565b60405180910390fd5b61061e33610488565b61065d576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610654906111cf565b60405180910390fd5b600160076000600454815260200190815260200160002060000160146101000a81548160ff02191690831515021790555060003373ffffffffffffffffffffffffffffffffffffffff166001546040516106b690611220565b60006040518083038185875af1925050503d80600081146106f3576040519150601f19603f3d011682016040523d82523d6000602084013e6106f8565b606091505b505090508061073c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161073390611281565b60405180910390fd5b7ffd44c2bf4d76bdb6f2e4dbe204c917a724b8dcb27454fdd47137a5048d3adaa533600454600154604051610773939291906112a1565b60405180910390a1600160025461078a9190611307565b600454101561079c5761079b610a81565b5b50565b60035481565b60045481565b60076020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060000160149054906101000a900460ff16908060020154905083565b60015481565b60025481565b610817336109e6565b15610857576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161084e90611387565b60405180910390fd5b600354341461089b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610892906113f3565b60405180910390fd5b600254600680549050106108e4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016108db90611485565b60405180910390fd5b6108ef336000610be2565b6108f93334610d2f565b7fe11711cd714e06fbbbea301a8e90822f2f2ea4808e37e3adf06038f33c53ff273360405161092891906110b5565b60405180910390a1565b61093c3334610d2f565b7f5dc1fe5ab986a852c4eda8e8bb94247d13307065c593fb83f1a09be2736793823360045434604051610971939291906112a1565b60405180910390a1565b60008060076000600454815260200190815260200160002090508060000160149054906101000a900460ff16156109b65760009150506109e3565b6001548160020154106109cd5760009150506109e3565b80600201546001546109df9190611307565b9150505b90565b60008073ffffffffffffffffffffffffffffffffffffffff16600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614159050919050565b60046000815480929190610a94906114a5565b91905055506000600660045481548110610ab157610ab06114ed565b5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610b4d576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b4490611568565b60405180910390fd5b8060076000600454815260200190815260200160002060000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507ff273f67b85d8a5a1f4a4fcd374395f0c2e76be79f5c8e8bf46d30fd8f392a5a660045482604051610bd7929190611588565b60405180910390a150565b60405180606001604052808373ffffffffffffffffffffffffffffffffffffffff168152602001821515815260200142815250600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160000160146101000a81548160ff021916908315150217905550604082015181600101559050506006829080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050565b610d38826109e6565b610d77576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d6e90611163565b60405180910390fd5b6003548114610dbb576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610db2906115fd565b60405180910390fd5b60076000600454815260200190815260200160002060010160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615610e5e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e5590611669565b60405180910390fd5b600160076000600454815260200190815260200160002060010160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550806007600060045481526020019081526020016000206002016000828254610ef49190611689565b925050819055505050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000610f2f82610f04565b9050919050565b610f3f81610f24565b8114610f4a57600080fd5b50565b600081359050610f5c81610f36565b92915050565b600060208284031215610f7857610f77610eff565b5b6000610f8684828501610f4d565b91505092915050565b610f9881610f24565b82525050565b60008115159050919050565b610fb381610f9e565b82525050565b6000819050919050565b610fcc81610fb9565b82525050565b6000606082019050610fe76000830186610f8f565b610ff46020830185610faa565b6110016040830184610fc3565b949350505050565b600060a08201905061101e6000830188610fc3565b61102b6020830187610f8f565b6110386040830186610fc3565b6110456060830185610fc3565b6110526080830184610faa565b9695505050505050565b61106581610fb9565b811461107057600080fd5b50565b6000813590506110828161105c565b92915050565b60006020828403121561109e5761109d610eff565b5b60006110ac84828501611073565b91505092915050565b60006020820190506110ca6000830184610f8f565b92915050565b60006020820190506110e56000830184610faa565b92915050565b60006020820190506111006000830184610fc3565b92915050565b600082825260208201905092915050565b7f4e6f7420612072656769737465726564207061727469636970616e7400000000600082015250565b600061114d601c83611106565b915061115882611117565b602082019050919050565b6000602082019050818103600083015261117c81611140565b9050919050565b7f43616e6e6f7420636c61696d20706f6f6c000000000000000000000000000000600082015250565b60006111b9601183611106565b91506111c482611183565b602082019050919050565b600060208201905081810360008301526111e8816111ac565b9050919050565b600081905092915050565b50565b600061120a6000836111ef565b9150611215826111fa565b600082019050919050565b600061122b826111fd565b9150819050919050565b7f5472616e73666572206661696c65640000000000000000000000000000000000600082015250565b600061126b600f83611106565b915061127682611235565b602082019050919050565b6000602082019050818103600083015261129a8161125e565b9050919050565b60006060820190506112b66000830186610f8f565b6112c36020830185610fc3565b6112d06040830184610fc3565b949350505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061131282610fb9565b915061131d83610fb9565b9250828203905081811115611335576113346112d8565b5b92915050565b7f5573657220416c72656164792052656769737465726564000000000000000000600082015250565b6000611371601783611106565b915061137c8261133b565b602082019050919050565b600060208201905081810360008301526113a081611364565b9050919050565b7f496e76616c696420436f6e747269627574696f6e20416d6f756e740000000000600082015250565b60006113dd601b83611106565b91506113e8826113a7565b602082019050919050565b6000602082019050818103600083015261140c816113d0565b9050919050565b7f526f7363612069732046756c6c2c20416c6c207061727469636970616e74732060008201527f616c726561647920726567697374657265640000000000000000000000000000602082015250565b600061146f603283611106565b915061147a82611413565b604082019050919050565b6000602082019050818103600083015261149e81611462565b9050919050565b60006114b082610fb9565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82036114e2576114e16112d8565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f496e76616c6964206e65787420726563697069656e7400000000000000000000600082015250565b6000611552601683611106565b915061155d8261151c565b602082019050919050565b6000602082019050818103600083015261158181611545565b9050919050565b600060408201905061159d6000830185610fc3565b6115aa6020830184610f8f565b9392505050565b7f496e76616c696420636f6e747269627574696f6e20616d6f756e740000000000600082015250565b60006115e7601b83611106565b91506115f2826115b1565b602082019050919050565b60006020820190508181036000830152611616816115da565b9050919050565b7f416c726561647920636f6e7472696275746564207468697320726f756e640000600082015250565b6000611653601e83611106565b915061165e8261161d565b602082019050919050565b6000602082019050818103600083015261168281611646565b9050919050565b600061169482610fb9565b915061169f83610fb9565b92508282019050808211156116b7576116b66112d8565b5b9291505056fea2646970667358221220051562ab0bba9c762fb1becaa5e80a4fb68ccea631c4d9b1d73c88664daabbc764736f6c634300081e0033";

// Types for contract interaction
export interface DeployParams {
  numberOfParticipants: number;
  totalAmount: number; // in ETH
}

export interface RoscaContractData {
  totalParticipants: bigint;
  totalAmount: bigint;
  contributionAmount: bigint;
  currentRound: bigint;
  participants: string[];
}

// Deployment function
export const deployRoscaContract = async (
  walletClient: any,
  publicClient: any,
  params: DeployParams
): Promise<string> => {
  try {
    // Get the connected account
    const [account] = await walletClient.getAddresses();

    // Calculate contribution amount (totalAmount / numberOfParticipants)
    const contributionAmount = params.totalAmount / params.numberOfParticipants;

    console.log('Deploying ROSCA contract with params:', {
      numberOfParticipants: params.numberOfParticipants,
      totalAmount: params.totalAmount,
      contributionAmount: contributionAmount,
      account: account
    });

    console.log('Contract args:', [
      BigInt(params.numberOfParticipants),
      parseEther(params.totalAmount.toString())
    ]);
    console.log('Value being sent:', parseEther(contributionAmount.toString()));

    // Deploy the contract
    const hash = await walletClient.deployContract({
      account,
      abi: roscaAbi,
      bytecode: roscaBytecode,
      args: [
        BigInt(params.numberOfParticipants),
        parseEther(params.totalAmount.toString())
      ],
      value: parseEther(contributionAmount.toString()),
    });

    console.log('Deployment transaction hash:', hash);

    // Wait for deployment to complete using public client
    const receipt = await publicClient.waitForTransactionReceipt({ hash });
    console.log('Contract deployed at address:', receipt.contractAddress);

    return receipt.contractAddress!;
  } catch (error) {
    console.error('Error deploying contract:', error);
    console.error('Error details:', {
      message: error.message,
      code: error.code,
      data: error.data,
      stack: error.stack
    });
    throw error;
  }
};

// React hook for contract deployment
export const useContractDeployment = () => {
  const { data: walletClient } = useWalletClient();
  const publicClient = usePublicClient();

  const deployContract = async (params: DeployParams): Promise<string> => {
    if (!walletClient) {
      throw new Error('Wallet not connected');
    }
    if (!publicClient) {
      throw new Error('No public client');
    }
    return deployRoscaContract(walletClient, publicClient, params);
  };

  return { deployContract };
};
